<div style="height: 100%">
  <div class="row" #Top>
    <div class="col-lg-12">
      <h3 class="mb-5" translate="LABEL.STATISTICAL"></h3>
    </div>
    <div
      class="col"
      *ngFor="let statistical of statisticals; let i = index"
      (click)="viewDetail(links[i])"
      [ngClass]="{ 'cursor-pointer': isVietec ? i < 2 : true }"
    >
      <div class="card card-custom card-stretch gutter-b">
        <div class="card-body p-5">
          <div class="d-flex align-items-center">
            <div class="symbol symbol-40 mr-3">
              <span class="symbol-label" style="background-color: transparent">
                <img alt="boy avatar" [src]="svg[i]" class="h-75 align-self-end" />
              </span>
            </div>
            <div class="d-flex flex-column flex-grow-1">
              <p class="text-dark mb-1 font-size-lg h6">
                <b>{{ statistical.max > 0 ? statistical.total + '/' + statistical.max : statistical.total }}</b>
              </p>
              <span class="text-muted">{{ statistical.title }}</span>
            </div>
            <div class="symbol symbol-40 mr-3" *ngIf="isVietec && i < 2 && links[i] != ''">
              <img alt="" src="./assets/icon/chevron-down.svg" class="h-75 align-self-end" />
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="row pb-6" [ngStyle]="{ height: 'calc(100% - 170px)' }">
    <div [ngClass]="{ 'col-md-4': !isSchool, 'col-md-8': isSchool }" style="height: 100%">
      <div class="card card-custom card-stretch">
        <div class="card-header border-0 pt-2 d-block">
          <h3 class="card-title font-weight-bolder text-dark">Thống kê học sinh</h3>
          <p class="text-gray-400 fw-bold">Thống kê học sinh theo năm học</p>
        </div>
        <div class="card-body pt-2 statistical-chart" style="height: calc(100% - 71.89px)">
          <ng-container *ngIf="isGetDataSuccess">
            <apx-chart
              [series]="chartOptions.series"
              [chart]="chartOptions.chart"
              [dataLabels]="chartOptions.dataLabels"
              [plotOptions]="chartOptions.plotOptions"
              [legend]="chartOptions.legend"
              [fill]="chartOptions.fill"
              [stroke]="chartOptions.stroke"
              [tooltip]="chartOptions.tooltip"
              [xaxis]="chartOptions.xaxis"
            ></apx-chart>
          </ng-container>
        </div>
      </div>
    </div>
    <div class="col-md-4" style="height: 100%" *ngIf="!isSchool">
      <div class="card card-custom card-stretch">
        <div class="card-header border-0 pt-2 d-block">
          <h3 class="card-title font-weight-bolder text-dark">Chương trình học</h3>
          <p class="text-gray-400 fw-bold">Phân bổ danh sách chương trình học KIDSEnglish</p>
        </div>
        <div class="card-body pt-2 statistical-program" style="height: calc(100% - 71.89px)">
          <div class="d-flex align-items-center" *ngFor="let pr of programRankings">
            <div class="row font-weight-bold" style="width: 100%">
              <div class="col-lg-5">
                <p class="font-size-lg">{{ pr.programName }}</p>
              </div>
              <div class="col-lg-7 d-flex">
                <p class="chart-bar ml-5" [ngStyle]="{ width: 'calc( ' + (pr.total * 80) / programRankings[0].total + '%' }"></p>
                <span class="ml-3">{{ pr.total }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-4" style="height: 100%" *ngIf="isSchool">
      <div class="card card-custom card-stretch">
        <div class="card-header border-0 pt-2 d-block">
          <h3 class="card-title font-weight-bolder text-dark">Tin tức</h3>
          <p class="text-gray-400 fw-bold">Cập nhật tin tức chương trình KIDSEnglish</p>
        </div>
        <div class="card-body pt-3 pb-0 custom-scoll-body mt-4 statistical-program">
          <div class="d-flex align-items-center mb-10" *ngFor="let n of news">
            <div class="symbol symbol-60 symbol-2by3 flex-shrink-0 mr-4">
              <div class="symbol-label" [ngStyle]="{ 'background-image': 'url(' + n.image + ')' }"></div>
            </div>
            <div class="d-flex flex-column flex-grow-1 my-lg-0 my-2 pr-3">
              <a href="javascript:;" class="text-dark-75 font-weight-bolder text-hover-primary text-line-2" (click)="openModal(n)">
                {{ n.title }}
              </a>
              <span class="text-muted font-weight-bold font-size-sm my-1"> {{ n.createdDate | timeAgo }} </span>
            </div>
          </div>
          <app-empty-table [length]="news?.length" [height]="100" text="Không có tin tức nào."> </app-empty-table>
        </div>
      </div>
    </div>
    <div class="col-md-4" style="height: 100%" *ngIf="!isVietec && !isSchool">
      <div class="card card-custom card-stretch">
        <div class="card-header border-0 pt-2 d-block">
          <h3 class="card-title font-weight-bolder text-dark">Trường học triển khai gần đây</h3>
          <p class="text-gray-400 fw-bold">Danh sách trường học triển khai KIDSEnlish gân đây</p>
        </div>
        <div class="card-body pt-2 statistical-province" style="height: calc(100% - 71.89px)">
          <ng-container *ngFor="let pr of schoolRankings">
            <div class="d-flex align-items-center p-1">
              <div class="d-flex flex-column flex-grow-1 font-weight-bold">
                <p class="font-size-lg mb-0">{{ pr.schoolName }}</p>
              </div>
            </div>
            <hr class="m-1" />
          </ng-container>
        </div>
      </div>
    </div>
    <div class="col-md-4" style="height: 100%" *ngIf="isVietec">
      <div class="card card-custom card-stretch">
        <div class="card-header border-0 pt-2">
          <div>
            <h3 class="card-title font-weight-bolder text-dark">Xếp hạng địa phương</h3>
            <p class="text-gray-400 fw-bold">Xếp hạng địa phương theo tiêu chí</p>
          </div>
          <div class="card-toolbar">
            <select class="form-control form-control-sm" (change)="changeFilter($event)">
              <option *ngFor="let ts of titleStatisticals" [value]="ts.key">{{ ts.title }}</option>
            </select>
          </div>
        </div>
        <div class="card-body pt-2 statistical-province" style="height: calc(100% - 71.89px)">
          <ng-container *ngFor="let pr of provinceRankings">
            <div class="d-flex align-items-center p-1">
              <div class="d-flex flex-column flex-grow-1 font-weight-bold">
                <p class="font-size-lg mb-0">{{ pr.provinceName }}</p>
              </div>
              <div class="ml-2" data-placement="left">{{ pr.total }}</div>
            </div>
            <hr class="m-1" />
          </ng-container>
        </div>
      </div>
    </div>
  </div>
</div>
